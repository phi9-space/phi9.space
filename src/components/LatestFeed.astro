---
import type { CollectionEntry } from "astro:content";

interface Props {
	posts: CollectionEntry<"blog">[];
	title?: string;
	placement?: "rail" | "inline";
}

const { posts, title = "Latest from the blog", placement = "rail" } = Astro.props as Props;
const sorted = [...posts]
	.sort((a, b) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf())
	.slice(0, 5);
const slotName = placement === "rail" ? "rail" : undefined;
---
<section class:list={{ 'latest-feed': true, 'latest-feed--inline': placement === 'inline' }} slot={slotName}>
  <p class="latest-feed__title">{title}</p>
  <ul class="latest-feed__list">
    {sorted.map((post) => (
      <li>
        <a
          href={`/blog/${post.slug}/`}
          class:list={{ 'latest-feed__link': true }}
        >
          <span class="latest-feed__date">{post.data.pubDate.toLocaleDateString('en-US', { month: 'short', day: 'numeric' })}</span>
          <span class="latest-feed__label">{post.data.title}</span>
        </a>
      </li>
    ))}
  </ul>
</section>

<style>
  .latest-feed {
    display: grid;
    gap: 1rem;
  }

  .latest-feed__title {
    text-transform: uppercase;
    letter-spacing: 0.18em;
    font-size: 0.75rem;
    color: rgba(40, 40, 40, 0.55);
    margin: 0;
  }

  .latest-feed__list {
    list-style: none;
    padding: 0;
    margin: 0;
    display: grid;
    gap: 0.75rem;
  }

  .latest-feed__link {
    display: grid;
    gap: 0.35rem;
    color: rgba(40, 40, 40, 0.7);
    padding: 0.75rem 0;
    transition: color 150ms ease;
  }

  .latest-feed__link:hover {
    color: var(--color-accent);
  }

  .latest-feed__date {
    font-size: 0.7rem;
    letter-spacing: 0.16em;
    text-transform: uppercase;
    color: rgba(40, 40, 40, 0.55);
  }

  .latest-feed__label {
    font-size: 0.9rem;
    font-weight: 500;
  }

  .latest-feed--inline {
    margin-top: clamp(2rem, 5vw, 2.8rem);
    width: 100%;
  }

  .latest-feed--inline .latest-feed__list {
    gap: 0.65rem;
  }
</style>
